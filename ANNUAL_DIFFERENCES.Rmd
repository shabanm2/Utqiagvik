---
title: "ANNUAL_DIFFERENCES"
author: "Mirella Shaban"
date: "2023-11-13"
output: html_document
---

####################################################################################################################################
This script compares air temperature, ground temperature, & VWC from 2022 to 2023 for summer 2022/summer 2023 & fall 2022/fall 2023
####################################################################################################################################


Loading packages
```{r}
library(ggplot2)
library(plyr)
library(dplyr)
library(lubridate)
library(tidyr)
library(gridExtra)
library(forcats)
library(splitstackshape) 
library(naniar)
library(RColorBrewer)
library(clock)
```

 ***                                                          #######################
                                                                 2022 DATA UPLOAD
 ***                                                          #######################
                                                          
--------------------------

    ######################               ######################
    ######################    SUMMER     ######################
    ######################               ######################
    
GRND TMP SUMMER 2022
```{r}
grndtmp22=read.csv("~/Desktop/UVA/RESEARCH/Barrow/Meteorological_Seasons_Data/Summer_22_grndtmp_2023_11_14_20_50_46_UTC_1.csv")
names(grndtmp22) <- sub("....C..RX3000_BRW1", "", names(grndtmp22))
names(grndtmp22) <- sub("....C..RX3000_BRW4", "", names(grndtmp22))
names(grndtmp22) <- sub("....C..RX3000_BRW5", "", names(grndtmp22))
names(grndtmp22) <- sub("....C..RX3000_BRW6", "", names(grndtmp22))
names(grndtmp22) <- sub(".RXW.GP6.", "", names(grndtmp22))
grndtmp22$Date <-as.POSIXct(grndtmp22$Date,format="%m/%d/%y %H:%M",tz="UTC")
```

VWC SUMMER 2022
```{r}
mst22=read.csv("~/Desktop/UVA/RESEARCH/Barrow/Meteorological_Seasons_Data/Summer_22_VWC_2023_11_14_21_00_08_UTC_1.csv")
names(mst22) <- sub("...m.3.m.3..RX3000_BRW1", "", names(mst22))
names(mst22) <- sub("...m.3.m.3..RX3000_BRW4", "", names(mst22))
names(mst22) <- sub("...m.3.m.3..RX3000_BRW5", "", names(mst22))
names(mst22) <- sub("...m.3.m.3..RX3000_BRW6", "", names(mst22))
names(mst22) <- sub("..RXW.GP6.", "", names(mst22))
mst22$Date <-as.POSIXct(mst22$Date,format="%m/%d/%y %H:%M",tz="UTC")
```

AIR SUMMER 2022
```{r}
air22 =read.csv("~/Desktop/UVA/RESEARCH/Barrow/Meteorological_Seasons_Data/Summer_22_airtmp_2023_11_14_20_57_51_UTC_1.csv")
names(air22) <- sub("Temperature..RXW.THC.", "" ,names(air22))
names(air22) <- sub("Temperature..S.THC.", "" ,names(air22))
names(air22) <- sub("S.", "" ,names(air22))
names(air22) <- sub("....C..RX3000_BRW1", "" ,names(air22))
names(air22) <- sub("....C..RX3000_BRW4", "" ,names(air22))
names(air22) <- sub("....C..RX3000_BRW5", "" ,names(air22))
names(air22) <- sub("....C..RX3000_BRW6", "" ,names(air22))
air22$Date <- as.POSIXct(air22$Date,format="%m/%d/%y %H:%M",tz="UTC")
```
  
  
    ######################               ######################
    ######################      FALL     ######################
    ######################               ######################


GRND TMP FALL 2022
```{r}
grndtmpfall22=read.csv("~/Desktop/UVA/RESEARCH/Barrow/Meteorological_Seasons_Data/Fall_22_grndtmp_2023_11_14_21_31_58_UTC_1.csv")
names(grndtmpfall22) <- sub("....C..RX3000_BRW1", "", names(grndtmpfall22))
names(grndtmpfall22) <- sub("....C..RX3000_BRW4", "", names(grndtmpfall22))
names(grndtmpfall22) <- sub("....C..RX3000_BRW5", "", names(grndtmpfall22))
names(grndtmpfall22) <- sub("....C..RX3000_BRW6", "", names(grndtmpfall22))
names(grndtmpfall22) <- sub(".RXW.GP6.", "", names(grndtmpfall22))
grndtmpfall22$Date <-as.POSIXct(grndtmpfall22$Date,format="%m/%d/%y %H:%M",tz="UTC")
```

VWC FALL 2022
```{r}
mstfall22=read.csv("~/Desktop/UVA/RESEARCH/Barrow/Meteorological_Seasons_Data/Fall_22_VWC_2023_11_14_21_46_41_UTC_1.csv")
names(mstfall22) <- sub("...m.3.m.3..RX3000_BRW1", "", names(mstfall22))
names(mstfall22) <- sub("...m.3.m.3..RX3000_BRW4", "", names(mstfall22))
names(mstfall22) <- sub("...m.3.m.3..RX3000_BRW5", "", names(mstfall22))
names(mstfall22) <- sub("...m.3.m.3..RX3000_BRW6", "", names(mstfall22))
names(mstfall22) <- sub("..RXW.GP6.", "", names(mstfall22))
mstfall22$Date <-as.POSIXct(mstfall22$Date,format="%m/%d/%y %H:%M",tz="UTC")
```

AIR FALL 2022
```{r}
airfall22 =read.csv("~/Desktop/UVA/RESEARCH/Barrow/Meteorological_Seasons_Data/Fall_22_airtmp_2023_11_14_21_43_57_UTC_1.csv")
names(airfall22) <- sub("Temperature..RXW.THC.", "" ,names(airfall22))
names(airfall22) <- sub("Temperature..S.THC.", "" ,names(airfall22))
names(airfall22) <- sub("S.", "" ,names(airfall22))
names(airfall22) <- sub("....C..RX3000_BRW1", "" ,names(airfall22))
names(airfall22) <- sub("....C..RX3000_BRW4", "" ,names(airfall22))
names(airfall22) <- sub("....C..RX3000_BRW5", "" ,names(airfall22))
names(airfall22) <- sub("....C..RX3000_BRW6", "" ,names(airfall22))
airfall22$Date <- as.POSIXct(airfall22$Date,format="%m/%d/%y %H:%M",tz="UTC")
```




***                                                             ########################
                                                                    2023 DATA UPLOAD
***                                                             ########################

---------------------------

    ######################               ######################
    ######################    SUMMER     ######################
    ######################               ######################
    
GRND TMP SUMMER 2023
```{r}
grndtmp_2023=read.csv("~/Desktop/UVA/RESEARCH/Barrow/Meteorological_Seasons_Data/UPDATED_SUMMER_23_DATA/New_Summer_2023_GRNDTMP_2023_11_01_18_32_40_UTC_1.csv") #NEED THIS DATA
names(grndtmp_2023) <- sub("....C..RX3000_BRW1", "", names(grndtmp_2023))
names(grndtmp_2023) <- sub("....C..RX3000_BRW4", "", names(grndtmp_2023))
names(grndtmp_2023) <- sub("....C..RX3000_BRW5", "", names(grndtmp_2023))
names(grndtmp_2023) <- sub("....C..RX3000_BRW6", "", names(grndtmp_2023))
names(grndtmp_2023) <- sub(".RXW.GP6.", "", names(grndtmp_2023))
grndtmp_2023$Date <-as.POSIXct(grndtmp_2023$Date,format="%m/%d/%y %H:%M", tz="UTC")
```

VWC SUMMER 2023
```{r}
mst_2023=read.csv("~/Desktop/UVA/RESEARCH/Barrow/Meteorological_Seasons_Data/UPDATED_SUMMER_23_DATA/New_Summer_2023_VWC_2023_11_01_18_34_52_UTC_1.csv") #THIS NEEDS TO BE COLLECTED!!!!
names(mst_2023) <- sub("...m.3.m.3..RX3000_BRW1", "", names(mst_2023))
names(mst_2023) <- sub("...m.3.m.3..RX3000_BRW4", "", names(mst_2023))
names(mst_2023) <- sub("...m.3.m.3..RX3000_BRW5", "", names(mst_2023))
names(mst_2023) <- sub("...m.3.m.3..RX3000_BRW6", "", names(mst_2023))
names(mst_2023) <- sub("..RXW.GP6.", "", names(mst_2023))
mst_2023$Date <-as.POSIXct(mst_2023$Date,format="%m/%d/%y %H:%M",tz="UTC")
```

Air SUMMER 2023
```{r}
air_2023 =read.csv("~/Desktop/UVA/RESEARCH/Barrow/Meteorological_Seasons_Data/UPDATED_SUMMER_23_DATA/New_Summer_2023_AIRTMP_2023_11_01_18_31_41_UTC_1.csv")
names(air_2023) <- sub("Temperature..RXW.THC.", "" ,names(air_2023))
names(air_2023) <- sub("Temperature..S.THC.", "" ,names(air_2023))
names(air_2023) <- sub("S.", "" ,names(air_2023))
names(air_2023) <- sub("....C..RX3000_BRW1", "" ,names(air_2023))
names(air_2023) <- sub("....C..RX3000_BRW4", "" ,names(air_2023))
names(air_2023) <- sub("....C..RX3000_BRW5", "" ,names(air_2023))
names(air_2023) <- sub("....C..RX3000_BRW6", "" ,names(air_2023))
air_2023$Date <- as.POSIXct(air_2023$Date,format="%m/%d/%y %H:%M",tz="UTC")
```

    ######################               ######################
    ######################    FALL       ######################
    ######################               ######################
    
    
GRND TMP FALL 2023
```{r}
```

VWC FALL 2023
```{r}
```

Air FALL 2023
```{r}
```





    
    
***                                                            ########################
                                                                   DATA CLEANING
                                                            ##########################
                                                            
                                                            
--------------                                                           

    ######################               ######################
    ######################  SUMMER       ######################
    ######################               ######################
                                                           ########################

------------------------------------------------------ 2022 SUMMER VWC --------------------------------------------
```{r}
dataframelong2 = gather(mst22, variable, response, Water.Content21198259.21206939.1:Water.Content21401803.21398591.6) %>%
  filter(!is.na(response)) %>%
  mutate(variable = fct_inorder(variable))

summer22vwc = cSplit(dataframelong2, 'variable', sep=".", direction = "wide") 
colnames(summer22vwc)[5:7] <- c("station", "sensor", "depth")
summer22vwc = cSplit(summer22vwc, 'station', sep="Content", direction = "wide") 
summer22vwc$variable_1 <- NULL 
summer22vwc$station_1 <- NULL 
summer22vwc$depth <- as.factor(as.character(summer22vwc$depth)) 
colnames(summer22vwc)[6] <- c("station")
summer22vwc$station <- as.factor(summer22vwc$station)
summer22vwc$sensor <- as.factor(as.character(summer22vwc$sensor))

summer22vwc$station <- revalue(summer22vwc$station, c("21198259" = "TNHA", "21401800" = "BUECI", "21401801" = "SSMH", "21401803" = "BEO")) 
summer22vwc$depth <- revalue(summer22vwc$depth, c("1" = "0:15cm", "2" = "15:30cm", "3" = "30:45cm", "4" = "45:60cm", "5" = "60:75cm", "6" = "75:90cm"))

summer22vwc$sensor <- revalue(summer22vwc$sensor, c('21206939'='TNHA-BASE','21393042'='BUECI-SC','21393044'='SSMH-SB','21393047'='TNHA-SC',"21393048" = "BEO-B06", "21398591" ="BEO-B05",'21393049'='SSMH-SD','21398578'='BUECI-SF01','21398579'='BUECI-SE','21398583'='BUECI-SB','21398584'='BUECI-SD','21398585'='BUECI-BASE','21398588'='SSMH-BASE','21398590'='BUECI-SA','21398591'='BEO-BASE','21398593'='TNHA-SA','21398598'='BUECI-SF02','21398599'='SSMH-SA','21398601'='TNHA-SD','21398587'='TNHA-SB')) 
```

-----------------------------------------------  2022 SUMMER Ground Temp ----------------------------------------------
```{r}
grndtmp = gather(grndtmp22, variable, response, "Temperature.21198259.21206939.7":"Temperature.21401803.21398591.17") %>%
  filter(!is.na(response)) %>%
  mutate(variable = fct_inorder(variable))
summer22grndtmp = cSplit(grndtmp, 'variable', sep=".", direction = "wide") 
summer22grndtmp$variable_1 <- NULL
colnames(summer22grndtmp)[3:6] <- c("value","station", "sensor", "depth")

summer22grndtmp$depth <- as.factor(as.character(summer22grndtmp$depth))
summer22grndtmp$sensor <- as.factor(as.character(summer22grndtmp$sensor))
summer22grndtmp$station <- as.factor(summer22grndtmp$station)
summer22grndtmp$station <- revalue(summer22grndtmp$station, c("21198259" = "TNHA", "21401800" = "BUECI", "21401801" = "SSMH", "21401803" = "BEO")) #renaming the stations
summer22grndtmp$sensor <- revalue(summer22grndtmp$sensor, c('21206939'='TNHA-BASE','21393042'='BUECI-SC','21393044'='SSMH-SB','21393047'='TNHA-SC','21393048'='BEO-B05','21393049'='SSMH-SD','21398578'='BUECI-SF01','21398579'='BUECI-SE','21398583'='BUECI-SB','21398584'='BUECI-SD','21398585'='BUECI-BASE','21398588'='SSMH-BASE','21398590'='BUECI-SA','21398591'='BEO-B06','21398593'='TNHA-SA','21398598'='BUECI-SF02','21398599'='SSMH-SA','21398601'='TNHA-SD','21398576'='SSMH-SC','21398587'='TNHA-SB'))

summer22grndtmp$depth <- revalue(summer22grndtmp$depth, c("7" = "3.5cm", "8" = "10cm", "9" = "20cm", "10" = "30cm", "11" = "40cm", "12" = "50cm", "13" = "55cm", "14" = "65cm", "15" = "75cm", "16" = "85cm", "17" = "90cm"))

summer22grndtmp$depth = factor(summer22grndtmp$depth, c("3.5cm","10cm", "20cm", "30cm", "40cm", "50cm", "55cm", "65cm", "75cm", "85cm", "90cm"))



```

-----------------------------------------------  2022 SUMMER Air Temp ----------------------------------------------
```{r}
airtemp = gather(air22, variable, response, "21198259.21218018.1":"21401803.21397541.1") %>%
  filter(!is.na(response)) %>%
  mutate(variable = fct_inorder(variable))

summer22airtemp= cSplit(airtemp, 'variable', sep=".", direction = "wide") 
summer22airtemp$variable_3 <- NULL
colnames(summer22airtemp)[3:5] <- c("value", "station", "sensor")
summer22airtemp$value <- as.numeric(as.character(summer22airtemp$value)) 
summer22airtemp$sensor <- as.factor(as.character(summer22airtemp$sensor))
summer22airtemp$station <- as.factor(summer22airtemp$station)

summer22airtemp$station <- revalue(summer22airtemp$station, c("21198259" = "TNHA", "21401800" = "BUECI", "21401801" = "SSMH", "21401803" = "BEO")) 

summer22airtemp$sensor <- revalue(summer22airtemp$sensor, c('21187245'='BUECI-SE','21218018'='TNHA-BASE','21362254'='BUECI-SB','21362256'='BUECI-SD','21380919'='TNHA-SA','21390849'='SSMH-BASE','21390851'='BUECI-BASE','21397541'='BEO-BASE','21398665'='SSMH-SB','21398666'='TNHA-SD','21398668'='BUECI-SC','21398670'='SSMH-SA','21398671'='BUECI-SA','21398674'='TNHA-SC','21398676'='TNHA-SB','21397542'='BUECI-BASE??','21398659'='BUECI-__','21398661'='BUECI-__','21398664'='TNHA-??'))

### need to correct the names for bueci stations, i dont have the metadata clearly on here for the air teperature sensors
```
  
    ######################               ######################
    ######################  FALL         ######################
    ######################               ######################
  



---------------------------------------------------------- 2022 FALL VWC ------------------------------------------------
```{r}
fall22vwc = gather(mstfall22, variable, response, Water.Content21198259.21206939.1:Water.Content21401800.21398576.6) %>%
  filter(!is.na(response)) %>%
  mutate(variable = fct_inorder(variable))

fall22vwc = cSplit(fall22vwc, 'variable', sep=".", direction = "wide") 
colnames(fall22vwc)[5:7] <- c("station", "sensor", "depth")
fall22vwc$variable_1 <- NULL 
fall22vwc$depth <- as.factor(as.character(fall22vwc$depth))
fall22vwc$station <- as.factor(fall22vwc$station)

fall22vwc$sensor <- as.factor(as.character(fall22vwc$sensor))

fall22vwc$station <- revalue(fall22vwc$station, c("Content21198259" = "TNHA", "Content21401800" = "BUECI", "Content21401801" = "SSMH", "Content21401803" = "BEO")) #renaming the stations
fall22vwc$depth <- revalue(fall22vwc$depth, c("1" = "0:15cm", "2" = "15:30cm", "3" = "30:45cm", "4" = "45:60cm", "5" = "60:75cm", "6" = "75:90cm"))

fall22vwc$sensor <- revalue(fall22vwc$sensor, c('21206939'='TNHA-BASE','21393042'='BUECI-SC','21393044'='SSMH-SB','21393047'='TNHA-SC','21393048'='BEO-BASE','21393049'='SSMH-SD','21398578'='BUECI-SF01','21398579'='BUECI-SE','21398583'='BUECI-SB','21398584'='BUECI-SD','21398585'='BUECI-BASE','21398588'='SSMH-BASE','21398590'='BUECI-SA','21398591'='BEO-BASE','21398593'='TNHA-SA','21398598'='BUECI-SF02','21398599'='SSMH-SA','21398601'='TNHA-SD','21398576'='REMOVE','21398587'='TNHA-SB')) 

```

------------------------------------------------------ 2022 FALL Ground Temp --------------------------------------------
```{r}
grndtemp = gather(grndtmpfall22, variable, response, "Temperature.21198259.21206939.7":"Temperature.21401803.21398591.17") %>%
  filter(!is.na(response)) %>%
  mutate(variable = fct_inorder(variable))
fall22grndtemp= cSplit(grndtemp, 'variable', sep=".", direction = "wide") 
colnames(fall22grndtemp)[3] <- c("value")
colnames(fall22grndtemp)[5:7] <- c( "station", "sensor", "depth")
fall22grndtemp$variable_1 <- NULL

fall22grndtemp$depth <- as.factor(as.character(fall22grndtemp$depth))
fall22grndtemp$sensor <- as.factor(as.character(fall22grndtemp$sensor))
fall22grndtemp$station <- as.factor(as.character(fall22grndtemp$station))
fall22grndtemp$station <- revalue(fall22grndtemp$station, c("21198259" = "TNHA", "21401800" = "BUECI", "21401801" = "SSMH", "21401803" = "BEO")) #renaming the stations
fall22grndtemp$sensor <- revalue(fall22grndtemp$sensor, c("21398585" = "BUECI-BASE", "21398590" = "BUECI-SA", "21398583" = "BUECI-SB", "21393042" = "BUECI-SC", "21398584" = "BUECI-SD", "21398579" = "BUECI-SE", "21398578" = "BUECI-SF.01", "21398598" = "BUECI-SF.02", "21398588" ="SSMH-BASE","21393049" = "SSMH-SD", "21398599" = "SSMH-SA", "21393044" = "SSMH-SB", "21393049" = "SSMH-SD" , "21206939" = "TNHA-BASE", "21398593" = "TNHA-SA", "21398587"="TNHA-SB","21398601" = "TNHA-SD", "21393047" = "TNHA-SC", "21393048" = "BEO-B06", "21398591" = "BEO-B05"))

fall22grndtemp$depth <- revalue(fall22grndtemp$depth, c("7" = "3.5cm", "8" = "10cm", "9" = "20cm", "10" = "30cm", "11" = "40cm", "12" = "50cm", "13" = "55cm", "14" = "65cm", "15" = "75cm", "16" = "85cm", "17" = "90cm"))

fall22grndtemp$depth = factor(fall22grndtemp$depth, c("3.5cm","10cm", "20cm", "30cm", "40cm", "50cm", "55cm", "65cm", "75cm", "85cm", "90cm"))

fall22grndtemp <- fall22grndtemp %>% filter(!value == -888.88)
```

------------------------------------------------------ 2022 FALL Air Temp --------------------------------------------
```{r}
airtemp = gather(airfall22, variable, response, "21198259.21218018.1":"21401803.21397541.1") %>%
  filter(!is.na(response)) %>%
  mutate(variable = fct_inorder(variable))

fall22airtemp= cSplit(airtemp, 'variable', sep=".", direction = "wide") 
fall22airtemp$variable_3 <- NULL
colnames(fall22airtemp)[3:5] <- c("value", "station", "sensor")
fall22airtemp$value <- as.numeric(as.character(fall22airtemp$value)) 
fall22airtemp$sensor <- as.factor(as.character(fall22airtemp$sensor))
fall22airtemp$station <- as.factor(fall22airtemp$station)

fall22airtemp$station <- revalue(fall22airtemp$station, c("21198259" = "TNHA", "21401800" = "BUECI", "21401801" = "SSMH", "21401803" = "BEO")) 

fall22airtemp$sensor <- revalue(fall22airtemp$sensor, c('21187245'='BUECI-SE','21218018'='TNHA-BASE','21362254'='BUECI-SB','21362256'='BUECI-SD','21380919'='TNHA-SA','21390849'='SSMH-BASE','21390851'='BUECI-BASE','21397541'='BEO-BASE','21398665'='SSMH-SB','21398666'='TNHA-SD','21398668'='BUECI-SC','21398670'='SSMH-SA','21398671'='BUECI-SA','21398674'='TNHA-SC','21398676'='TNHA-SB','21397542'='BUECI-BASE??','21398659'='BUECI-__','21398661'='BUECI-__','21398664'='TNHA-??'))
```



***                                                              #######################
                                                                   2023 DATA CLEANING
***                                                              #######################  
                                                             
                                     
                                                             
    ######################               ######################
    ######################  SUMMER       ######################
   
    ######################               ######################    
 
    
-----------------------------------------------  2023 Summer VWC ------------------------------------------------------

```{r}
dataframelong2 = gather(mst_2023, variable, response, Water.Content21198259.21206939.1_TNHA:Water.Content21401803.21398591.6_BEO) %>%
  filter(!is.na(response)) %>%
  mutate(variable = fct_inorder(variable))

summer23vwc = cSplit(dataframelong2, 'variable', sep=".", direction = "wide") 
colnames(summer23vwc)[5:7] <- c("station", "sensor", "depth")
summer23vwc = cSplit(summer23vwc, 'station', sep="Content", direction = "wide") 
summer23vwc$variable_1 <- NULL 
summer23vwc$station_1 <- NULL 
summer23vwc$depth <- as.factor(as.character(summer23vwc$depth)) 
colnames(summer23vwc)[6] <- c("station")
summer23vwc$station <- as.factor(summer23vwc$station)
summer23vwc$sensor <- as.factor(as.character(summer23vwc$sensor))

summer23vwc$station <- revalue(summer23vwc$station, c("21198259" = "TNHA", "21401800" = "BUECI", "21401801" = "SSMH", "21401803" = "BEO")) 
summer23vwc$depth <- revalue(summer23vwc$depth, c("1" = "0:15cm", "2" = "15:30cm", "3" = "30:45cm", "4" = "45:60cm", "5" = "60:75cm", "6" = "75:90cm"))

summer23vwc$sensor <- revalue(summer23vwc$sensor, c('21206939'='TNHA-BASE','21393042'='BUECI-SC','21393044'='SSMH-SB','21393047'='TNHA-SC',"21393048" = "BEO-B06", "21398591" ="BEO-B05",'21393049'='SSMH-SD','21398578'='BUECI-SF01','21398579'='BUECI-SE','21398583'='BUECI-SB','21398584'='BUECI-SD','21398585'='BUECI-BASE','21398588'='SSMH-BASE','21398590'='BUECI-SA','21398591'='BEO-BASE','21398593'='TNHA-SA','21398598'='BUECI-SF02','21398599'='SSMH-SA','21398601'='TNHA-SD','21398587'='TNHA-SB')) 
```

-----------------------------------------------  2023 Summer Air Temp-----------------------------------------------
```{r}
airtempsum23 = gather(air_2023, variable, response, "21198259.21380919.1_TNHA":"21401801.21398667.1_MH") %>%
  filter(!is.na(response)) %>%
  mutate(variable = fct_inorder(variable))

summer23airtemp= cSplit(airtempsum23, 'variable', sep=".", direction = "wide") 
summer23airtemp= cSplit(summer23airtemp, 'variable_3', sep="1_", direction = "wide") 
summer23airtemp$variable_3_1 <- NULL
colnames(summer23airtemp)[3:6] <- c("value", "station", "sensor","site")
summer23airtemp$value <- as.numeric(as.character(summer23airtemp$value)) 
summer23airtemp$sensor <- as.factor(as.character(summer23airtemp$sensor))
summer23airtemp$station <- as.factor(summer23airtemp$station)
summer23airtemp$site <- as.factor(summer23airtemp$site)
summer23airtemp$station <- revalue(summer23airtemp$station, c("21198259" = "TNHA", "21401800" = "BUECI", "21401801" = "SSMH", "21401803" = "BEO")) 

summer23airtemp$sensor <- revalue(summer23airtemp$sensor, c('21187245'='BUECI-SE','21218018'='TNHA-BASE','21362254'='BUECI-SB','21362256'='BUECI-SD','21380919'='TNHA-SA','21390849'='SSMH-BASE','21390851'='BUECI-BASE','21397541'='BEO-BASE','21398665'='SSMH-SB','21398666'='TNHA-SD','21398668'='BUECI-SC','21398670'='SSMH-SA','21398671'='BUECI-SA','21398674'='TNHA-SC','21398676'='TNHA-SB','21397542'='BUECI-BASE??','21398659'='BUECI-__','21398661'='BUECI-__','21398664'='TNHA-??'))


#### need to adjust for the air temp sensors
```


-----------------------------------------------  2023 Summer Ground Temp-----------------------------------------------
```{r}
grndtmp = gather(grndtmp_2023, variable, response, Temperature.21198259.21206939.7_TNHA:Temperature.21401803.21398591.17_BEO) %>%
  mutate(variable = fct_inorder(variable))
sum23grndtmp= cSplit(grndtmp, 'variable', sep=".", direction = "wide") 
colnames(sum23grndtmp)[3] <- ("value")
colnames(sum23grndtmp)[5:7] <- c("station", "sensor", "depth")
sum23grndtmp= cSplit(sum23grndtmp, 'depth', sep="_", direction = "wide") 
colnames(sum23grndtmp)[7] <- ("depth")
sum23grndtmp$variable_1 <- NULL
sum23grndtmp$depth_2 <- NULL

sum23grndtmp$depth <- as.factor(as.character(sum23grndtmp$depth))
sum23grndtmp$sensor <- as.factor(as.character(sum23grndtmp$sensor))
sum23grndtmp$station <- as.factor(sum23grndtmp$station)
sum23grndtmp$station <- revalue(sum23grndtmp$station, c("21198259" = "TNHA", "21401800" = "BUECI", "21401801" = "SSMH", "21401803" = "BEO")) #renaming the stations
sum23grndtmp$sensor <- revalue(sum23grndtmp$sensor, c("21398585" = "BUECI-BASE", "21398590" = "BUECI-SA", "21398583" = "BUECI-SB", "21393042" = "BUECI-SC", "21398584" = "BUECI-SD", "21398579" = "BUECI-SE", "21398578" = "BUECI-SF.01", "21398598" = "BUECI-SF.02", "21398588" ="SSMH-BASE","21393049" = "SSMH-SD", "21398599" = "SSMH-SA", "21393044" = "SSMH-SB", "21393049" = "SSMH-SD" , "21206939" = "TNHA-BASE", "21398593" = "TNHA-SA", "21398576"="TNHA-SB","21398587" = "TNHA-SB","21398601" = "TNHA-SD", "21393047" = "TNHA-SC", "21393048" = "BEO-B06", "21398591" = "BEO-B05"))

sum23grndtmp$depth <- revalue(sum23grndtmp$depth, c("7" = "3.5cm", "8" = "10cm", "9" = "20cm", "10" = "30cm", "11" = "40cm", "12" = "50cm", "13" = "55cm", "14" = "65cm", "15" = "75cm", "16" = "85cm", "17" = "90cm"))

sum23grndtmp$depth = factor(sum23grndtmp$depth, c("3.5cm","10cm", "20cm", "30cm", "40cm", "50cm", "55cm", "65cm", "75cm", "85cm", "90cm"))

sum23grndtmp <- sum23grndtmp %>% filter(!value == -888.88)

```


                                                          # dont have the fall csv's yet #

    ######################               ######################
    ######################  FALL         ######################
    ######################               ######################


----------------------------------------------  2023 Fall VWC -----------------------------------------------

-----------------------------------------------  2023 Fall Air Temp -----------------------------------------------

-----------------------------------------------  2023 Fall Ground Temp -----------------------------------------------




####################################################################################################################################
                                                      AVERAGING DATA PER SEASON & PER DEPTH

####################################################################################################################################
*ground temp:*
summer 22: summer22grndtmp
summer 23: sum23grndtmp
fall 22: fall22grndtemp
fall 23:

*air temp:*
summer 22: summer22airtemp
summer 23: summer23airtemp
fall 22: fall22airtemp
fall 23:
####################################################################################################################################




###################
SEASONAL AVERAGING#
####################

BY STATION




AIR TEMPERATURE AVERAGING BY STATION AND YEAR
-------------
SUMMER 22
```{r}
AIRmean <- summer22airtemp %>% subset() %>% select(value,sensor,Date) %>% filter( !value == "-888.8") 

AIRmean %>%
  mutate(date = day(Date))  %>%
  group_by(date,sensor,value) %>%
  summarize(mean_X1 = mean(value)) %>% 
  aggregate( value ~ sensor, mean ) %>%
  group_by(sensor)

AIRmean$time <- format(as.Date(
  AIRmean$Date),format = "%H:%M:%S")
AIRmean$day <- as.Date(AIRmean$Date)


Daily_average_air_per_sensor <- AIRmean %>% 
  group_by(sensor, day) %>%
  aggregate(value ~ sensor + day, mean)


Daily_average_air_per_sensor <-  cSplit(Daily_average_air_per_sensor, 'sensor', sep="-", direction = "wide")
colnames(Daily_average_air_per_sensor)[1:4] <- c("date","value","station","sensor")
Daily_average_air_per_sensor$fullname <- paste(Daily_average_air_per_sensor$station,Daily_average_air_per_sensor$sensor,sep="-")


TNHA_DAILY <- Daily_average_air_per_sensor %>% filter(station == "TNHA")
SSMH_DAILY<- Daily_average_air_per_sensor %>% filter(station == "SSMH")
BEO_DAILY<- Daily_average_air_per_sensor %>% filter(station == "BEO")


date <- rep(seq(as.Date("2022-06-19"), as.Date("2022-09-01"), by="day"),5)
val <- rep(1,length(date))
fullname <- rep(c("TNHA-BASE", "TNHA-SA", "TNHA-SB", "TNHA-SC", "TNHA-SD"),each=75)
testdf <- data.frame(date,fullname,val)
TNHA_NONA <- left_join(testdf,TNHA_DAILY, by=c("date","fullname"))

fullname <- rep(c("SSMH-BASE", "SSMH-SA", "SSMH-SB", "SSMH-SC", "SSMH-SD"),each=75)
testdf2 <- data.frame(date,fullname,val)
SSMH_NONA <- left_join(testdf2,SSMH_DAILY, by=c("date","fullname"))

fullname <- rep(c("BEO-BASE"),each=75)
testdf3 <- data.frame(date,fullname,val)
BEO_NONA <- left_join(testdf3,BEO_DAILY, by=c("date","fullname"))

SUMMER22_air <- rbind(TNHA_NONA,BEO_NONA,SSMH_NONA)
```

FALL 22
```{r}
AIRmean <- fall22airtemp %>% subset() %>% select(value,sensor,Date) %>% filter( !value == "-888.8") 

AIRmean %>%
  mutate(date = day(Date))  %>%
  group_by(date,sensor,value) %>%
  summarize(mean_X1 = mean(value)) %>% 
  aggregate( value ~ sensor, mean ) %>%
  group_by(sensor)

AIRmean$time <- format(as.Date(
  AIRmean$Date),format = "%H:%M:%S")
AIRmean$day <- as.Date(AIRmean$Date)


Daily_average_air_per_sensor <- AIRmean %>% 
  group_by(sensor, day) %>%
  aggregate(value ~ sensor + day, mean)


Daily_average_air_per_sensor <-  cSplit(Daily_average_air_per_sensor, 'sensor', sep="-", direction = "wide")
colnames(Daily_average_air_per_sensor)[1:4] <- c("date","value","station","sensor")
Daily_average_air_per_sensor$fullname <- paste(Daily_average_air_per_sensor$station,Daily_average_air_per_sensor$sensor,sep="-")


TNHA_DAILY <- Daily_average_air_per_sensor %>% filter(station == "TNHA")
SSMH_DAILY<- Daily_average_air_per_sensor %>% filter(station == "SSMH")
BEO_DAILY<- Daily_average_air_per_sensor %>% filter(station == "BEO")


date <- rep(seq(as.Date("2022-09-01"), as.Date("2022-12-01"), by="day"),5)
val <- rep(1,length(date))
fullname <- rep(c("TNHA-BASE", "TNHA-SA", "TNHA-SB", "TNHA-SC", "TNHA-SD"),each=92)
testdf <- data.frame(date,fullname,val)
TNHA_NONA <- left_join(testdf,TNHA_DAILY, by=c("date","fullname"))

fullname <- rep(c("SSMH-BASE", "SSMH-SA", "SSMH-SB", "SSMH-SC", "SSMH-SD"),each=92)
testdf2 <- data.frame(date,fullname,val)
SSMH_NONA <- left_join(testdf2,SSMH_DAILY, by=c("date","fullname"))

fullname <- rep(c("BEO-BASE"),each=92)
testdf3 <- data.frame(date,fullname,val)
BEO_NONA <- left_join(testdf3,BEO_DAILY, by=c("date","fullname"))

FALL22_air <- rbind(TNHA_NONA,BEO_NONA,SSMH_NONA)
```


SUMMER 23
```{r}
AIRmean <- summer23airtemp %>% subset() %>% select(value,sensor,Date) %>% filter(!value == "-888.8" | !value == "128.830000") 
#this latter filter for the value isnt working

AIRmean %>%
  mutate(date = day(Date))  %>%
  group_by(date,sensor,value) %>%
  summarize(mean_X1 = mean(value)) %>% 
  aggregate( value ~ sensor, mean ) %>%
  group_by(sensor)

AIRmean$time <- format(as.Date(
  AIRmean$Date),format = "%H:%M:%S")
AIRmean$day <- as.Date(AIRmean$Date)


Daily_average_airper_sensor <- AIRmean %>% 
  group_by(sensor, day) %>%
  aggregate(value ~ sensor + day, mean)


Daily_average_airper_sensor <-  cSplit(Daily_average_airper_sensor, 'sensor', sep="-", direction = "wide")
colnames(Daily_average_airper_sensor)[1:4] <- c("date","value","station","sensor")
Daily_average_airper_sensor$fullname <- paste(Daily_average_airper_sensor$station,Daily_average_airper_sensor$sensor,sep="-")


TNHA_DAILY <- Daily_average_airper_sensor %>% filter(station == "TNHA")
SSMH_DAILY<- Daily_average_airper_sensor %>% filter(station == "SSMH")
BEO_DAILY<- Daily_average_airper_sensor %>% filter(station == "BEO")


date <- rep(seq(as.Date("2023-06-01"), as.Date("2023-09-01"), by="day"),5)
val <- rep(1,length(date))
fullname <- rep(c("TNHA-BASE", "TNHA-SA", "TNHA-SB", "TNHA-SC", "TNHA-SD"),each=93)
testdf <- data.frame(date,fullname,val)
TNHA_NONA <- left_join(testdf,TNHA_DAILY, by=c("date","fullname"))

fullname <- rep(c("SSMH-BASE", "SSMH-SA", "SSMH-SB", "SSMH-SC", "SSMH-SD"),each=93)
testdf2 <- data.frame(date,fullname,val)
SSMH_NONA <- left_join(testdf2,SSMH_DAILY, by=c("date","fullname"))

fullname <- rep(c("BEO-BASE"),each=93)
testdf3 <- data.frame(date,fullname,val)
BEO_NONA <- left_join(testdf3,BEO_DAILY, by=c("date","fullname"))

SUMMER23_air <- rbind(TNHA_NONA,BEO_NONA,SSMH_NONA)
SUMMER23_air <- SUMMER23_air %>% filter(!value >= "128")
```







GROUND TEMPERATURES
*SUMMER 22*

BY STATION
-------------------
10cm
```{r}
grndmean <- summer22grndtmp %>% subset() %>% select(value,sensor,Date,depth) %>% filter( !value == "-888.8", depth == "10cm") 

grndmean %>%
  mutate(date = day(Date))  %>%
  group_by(date,sensor,value) %>%
  summarize(mean_X1 = mean(value)) %>% 
  aggregate( value ~ sensor, mean ) %>%
  group_by(sensor)

grndmean$time <- format(as.Date(
  grndmean$Date),format = "%H:%M:%S")
grndmean$day <- as.Date(grndmean$Date)


Daily_average_grnd_per_sensor <- grndmean %>% 
  group_by(sensor, day) %>%
  aggregate(value ~ sensor + day, mean)


Daily_average_grnd_per_sensor <-  cSplit(Daily_average_grnd_per_sensor, 'sensor', sep="-", direction = "wide")
colnames(Daily_average_grnd_per_sensor)[1:4] <- c("date","value","station","sensor")
Daily_average_grnd_per_sensor$fullname <- paste(Daily_average_grnd_per_sensor$station,Daily_average_grnd_per_sensor$sensor,sep="-")


TNHA_DAILY <- Daily_average_grnd_per_sensor %>% filter(station == "TNHA")
SSMH_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "SSMH")
BEO_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "BEO")


date <- rep(seq(as.Date("2022-06-19"), as.Date("2022-09-01"), by="day"),5)
val <- rep(1,length(date))
fullname <- rep(c("TNHA-BASE", "TNHA-SA", "TNHA-SB", "TNHA-SC", "TNHA-SD"),each=75)
testdf <- data.frame(date,fullname,val)
TNHA_NONA <- left_join(testdf,TNHA_DAILY, by=c("date","fullname"))

fullname <- rep(c("SSMH-BASE", "SSMH-SA", "SSMH-SB", "SSMH-SC", "SSMH-SD"),each=75)
testdf2 <- data.frame(date,fullname,val)
SSMH_NONA <- left_join(testdf2,SSMH_DAILY, by=c("date","fullname"))

fullname <- rep(c("BEO-B05", "BEO-B06","FAKEVAR", "FAKEVAR2", "FAKEVAR3"),each=75)
testdf3 <- data.frame(date,fullname,val)
BEO_NONA <- left_join(testdf3,BEO_DAILY, by=c("date","fullname"))

SUMMER22_10CM <- rbind(TNHA_NONA,BEO_NONA,SSMH_NONA)
SUMMER22_10CM$depth <- "10cm"
SUMMER22_10CM$depth <- as.factor(SUMMER22_10CM$depth)
```

30cm
```{r}
grndmean <- summer22grndtmp %>% subset() %>% select(value,sensor,Date,depth) %>% filter( !value == "-888.8", depth == "30cm") 

grndmean %>%
  mutate(date = day(Date))  %>%
  group_by(date,sensor,value) %>%
  summarize(mean_X1 = mean(value)) %>% 
  aggregate( value ~ sensor, mean ) %>%
  group_by(sensor)

grndmean$time <- format(as.Date(
  grndmean$Date),format = "%H:%M:%S")
grndmean$day <- as.Date(grndmean$Date)


Daily_average_grnd_per_sensor <- grndmean %>% 
  group_by(sensor, day) %>%
  aggregate(value ~ sensor + day, mean)


Daily_average_grnd_per_sensor <-  cSplit(Daily_average_grnd_per_sensor, 'sensor', sep="-", direction = "wide")
colnames(Daily_average_grnd_per_sensor)[1:4] <- c("date","value","station","sensor")
Daily_average_grnd_per_sensor$fullname <- paste(Daily_average_grnd_per_sensor$station,Daily_average_grnd_per_sensor$sensor,sep="-")


TNHA_DAILY <- Daily_average_grnd_per_sensor %>% filter(station == "TNHA")
SSMH_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "SSMH")
BEO_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "BEO")


date <- rep(seq(as.Date("2022-06-19"), as.Date("2022-09-01"), by="day"),5)
val <- rep(1,length(date))
fullname <- rep(c("TNHA-BASE", "TNHA-SA", "TNHA-SB", "TNHA-SC", "TNHA-SD"),each=75)
testdf <- data.frame(date,fullname,val)
TNHA_NONA <- left_join(testdf,TNHA_DAILY, by=c("date","fullname"))

fullname <- rep(c("SSMH-BASE", "SSMH-SA", "SSMH-SB", "SSMH-SC", "SSMH-SD"),each=75)
testdf2 <- data.frame(date,fullname,val)
SSMH_NONA <- left_join(testdf2,SSMH_DAILY, by=c("date","fullname"))

fullname <- rep(c("BEO-B05", "BEO-B06","FAKEVAR", "FAKEVAR2", "FAKEVAR3"),each=75)
testdf3 <- data.frame(date,fullname,val)
BEO_NONA <- left_join(testdf3,BEO_DAILY, by=c("date","fullname"))

SUMMER22_30CM <- rbind(TNHA_NONA,BEO_NONA,SSMH_NONA)
SUMMER22_30CM$depth <- "30cm"
SUMMER22_30CM$depth <- as.factor(SUMMER22_30CM$depth)
```

55cm
```{r}
grndmean <- summer22grndtmp %>% subset() %>% select(value,sensor,Date,depth) %>% filter( !value == "-888.8", depth == "55cm") 

grndmean %>%
  mutate(date = day(Date))  %>%
  group_by(date,sensor,value) %>%
  summarize(mean_X1 = mean(value)) %>% 
  aggregate( value ~ sensor, mean ) %>%
  group_by(sensor)

grndmean$time <- format(as.Date(
  grndmean$Date),format = "%H:%M:%S")
grndmean$day <- as.Date(grndmean$Date)


Daily_average_grnd_per_sensor <- grndmean %>% 
  group_by(sensor, day) %>%
  aggregate(value ~ sensor + day, mean)


Daily_average_grnd_per_sensor <-  cSplit(Daily_average_grnd_per_sensor, 'sensor', sep="-", direction = "wide")
colnames(Daily_average_grnd_per_sensor)[1:4] <- c("date","value","station","sensor")
Daily_average_grnd_per_sensor$fullname <- paste(Daily_average_grnd_per_sensor$station,Daily_average_grnd_per_sensor$sensor,sep="-")


TNHA_DAILY <- Daily_average_grnd_per_sensor %>% filter(station == "TNHA")
SSMH_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "SSMH")
BEO_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "BEO")


date <- rep(seq(as.Date("2022-06-19"), as.Date("2022-09-01"), by="day"),5)
val <- rep(1,length(date))
fullname <- rep(c("TNHA-BASE", "TNHA-SA", "TNHA-SB", "TNHA-SC", "TNHA-SD"),each=75)
testdf <- data.frame(date,fullname,val)
TNHA_NONA <- left_join(testdf,TNHA_DAILY, by=c("date","fullname"))

fullname <- rep(c("SSMH-BASE", "SSMH-SA", "SSMH-SB", "SSMH-SC", "SSMH-SD"),each=75)
testdf2 <- data.frame(date,fullname,val)
SSMH_NONA <- left_join(testdf2,SSMH_DAILY, by=c("date","fullname"))

fullname <- rep(c("BEO-B05", "BEO-B06","FAKEVAR", "FAKEVAR2", "FAKEVAR3"),each=75)
testdf3 <- data.frame(date,fullname,val)
BEO_NONA <- left_join(testdf3,BEO_DAILY, by=c("date","fullname"))

SUMMER22_55CM <- rbind(TNHA_NONA,BEO_NONA,SSMH_NONA)
SUMMER22_55CM$depth <- "55cm"
SUMMER22_55CM$depth <- as.factor(SUMMER22_55CM$depth)
```

65cm
```{r}
grndmean <- summer22grndtmp %>% subset() %>% select(value,sensor,Date,depth) %>% filter( !value == "-888.8", depth == "65cm") 

grndmean %>%
  mutate(date = day(Date))  %>%
  group_by(date,sensor,value) %>%
  summarize(mean_X1 = mean(value)) %>% 
  aggregate( value ~ sensor, mean ) %>%
  group_by(sensor)

grndmean$time <- format(as.Date(
  grndmean$Date),format = "%H:%M:%S")
grndmean$day <- as.Date(grndmean$Date)


Daily_average_grnd_per_sensor <- grndmean %>% 
  group_by(sensor, day) %>%
  aggregate(value ~ sensor + day, mean)


Daily_average_grnd_per_sensor <-  cSplit(Daily_average_grnd_per_sensor, 'sensor', sep="-", direction = "wide")
colnames(Daily_average_grnd_per_sensor)[1:4] <- c("date","value","station","sensor")
Daily_average_grnd_per_sensor$fullname <- paste(Daily_average_grnd_per_sensor$station,Daily_average_grnd_per_sensor$sensor,sep="-")


TNHA_DAILY <- Daily_average_grnd_per_sensor %>% filter(station == "TNHA")
SSMH_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "SSMH")
BEO_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "BEO")


date <- rep(seq(as.Date("2022-06-19"), as.Date("2022-09-01"), by="day"),5)
val <- rep(1,length(date))
fullname <- rep(c("TNHA-BASE", "TNHA-SA", "TNHA-SB", "TNHA-SC", "TNHA-SD"),each=75)
testdf <- data.frame(date,fullname,val)
TNHA_NONA <- left_join(testdf,TNHA_DAILY, by=c("date","fullname"))

fullname <- rep(c("SSMH-BASE", "SSMH-SA", "SSMH-SB", "SSMH-SC", "SSMH-SD"),each=75)
testdf2 <- data.frame(date,fullname,val)
SSMH_NONA <- left_join(testdf2,SSMH_DAILY, by=c("date","fullname"))

fullname <- rep(c("BEO-B05", "BEO-B06","FAKEVAR", "FAKEVAR2", "FAKEVAR3"),each=75)
testdf3 <- data.frame(date,fullname,val)
BEO_NONA <- left_join(testdf3,BEO_DAILY, by=c("date","fullname"))

SUMMER22_65CM <- rbind(TNHA_NONA,BEO_NONA,SSMH_NONA)
SUMMER22_65CM$depth <- "65cm"
SUMMER22_65CM$depth <- as.factor(SUMMER22_65CM$depth)
```

90cm
```{r}
grndmean <- summer22grndtmp %>% subset() %>% select(value,sensor,Date,depth) %>% filter( !value == "-888.8", depth == "90cm") 

grndmean %>%
  mutate(date = day(Date))  %>%
  group_by(date,sensor,value) %>%
  summarize(mean_X1 = mean(value)) %>% 
  aggregate( value ~ sensor, mean ) %>%
  group_by(sensor)

grndmean$time <- format(as.Date(
  grndmean$Date),format = "%H:%M:%S")
grndmean$day <- as.Date(grndmean$Date)


Daily_average_grnd_per_sensor <- grndmean %>% 
  group_by(sensor, day) %>%
  aggregate(value ~ sensor + day, mean)


Daily_average_grnd_per_sensor <-  cSplit(Daily_average_grnd_per_sensor, 'sensor', sep="-", direction = "wide")
colnames(Daily_average_grnd_per_sensor)[1:4] <- c("date","value","station","sensor")
Daily_average_grnd_per_sensor$fullname <- paste(Daily_average_grnd_per_sensor$station,Daily_average_grnd_per_sensor$sensor,sep="-")


TNHA_DAILY <- Daily_average_grnd_per_sensor %>% filter(station == "TNHA")
SSMH_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "SSMH")
BEO_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "BEO")


date <- rep(seq(as.Date("2022-06-19"), as.Date("2022-09-01"), by="day"),5)
val <- rep(1,length(date))
fullname <- rep(c("TNHA-BASE", "TNHA-SA", "TNHA-SB", "TNHA-SC", "TNHA-SD"),each=75)
testdf <- data.frame(date,fullname,val)
TNHA_NONA <- left_join(testdf,TNHA_DAILY, by=c("date","fullname"))

fullname <- rep(c("SSMH-BASE", "SSMH-SA", "SSMH-SB", "SSMH-SC", "SSMH-SD"),each=75)
testdf2 <- data.frame(date,fullname,val)
SSMH_NONA <- left_join(testdf2,SSMH_DAILY, by=c("date","fullname"))

fullname <- rep(c("BEO-B05", "BEO-B06","FAKEVAR", "FAKEVAR2", "FAKEVAR3"),each=75)
testdf3 <- data.frame(date,fullname,val)
BEO_NONA <- left_join(testdf3,BEO_DAILY, by=c("date","fullname"))

SUMMER22_90CM <- rbind(TNHA_NONA,BEO_NONA,SSMH_NONA)
SUMMER22_90CM$depth <- "90cm"
SUMMER22_90CM$depth <- as.factor(SUMMER22_90CM$depth)
```



Bind all depth dataframes together
```{r}
SUMMERGRND22_ALLDEPTHS <- rbind(SUMMER22_10CM,SUMMER22_30CM,SUMMER22_55CM,SUMMER22_65CM,SUMMER22_90CM)
```


BY SITE
-----------
```{r}
averaged_by_site_TNHA <- SUMMERGRND22_ALLDEPTHS %>% filter(fullname == "TNHA-BASE" | fullname == "TNHA-SA" | fullname == "TNHA-SB"| fullname == "TNHA-SC" | fullname == "TNHA-SD") %>% aggregate(value~date+depth, mean)
averaged_by_site_TNHA$station <- c("TNHA")

averaged_by_site_BEO <- SUMMERGRND22_ALLDEPTHS %>% filter(fullname == "BEO-B06" | fullname == "BEO-B05") %>% aggregate(value~date+depth, mean)
averaged_by_site_BEO$station <- c("BEO") 

averaged_by_site_SSMH <- SUMMERGRND22_ALLDEPTHS %>% filter(fullname == "SSMH-BASE" | fullname == "SSMH-SA" | fullname == "SSMH-SB"| fullname == "SSMH-SC" | fullname == "SSMH-SD") %>% aggregate(value~date+depth, mean)
averaged_by_site_SSMH$station <- c("SSMH")

SITES_AVG_SUM22_GRND <- rbind(averaged_by_site_BEO, averaged_by_site_TNHA, averaged_by_site_SSMH)
```



*FALL 22*
BY STATION
-------------------
10cm
```{r}
grndmean <- fall22grndtemp %>% subset() %>% select(value,sensor,Date,depth) %>% filter( !value == "-888.8", depth == "10cm") 

grndmean %>%
  mutate(date = day(Date))  %>%
  group_by(date,sensor,value) %>%
  summarize(mean_X1 = mean(value)) %>% 
  aggregate( value ~ sensor, mean ) %>%
  group_by(sensor)

grndmean$time <- format(as.Date(
  grndmean$Date),format = "%H:%M:%S")
grndmean$day <- as.Date(grndmean$Date)


Daily_average_grnd_per_sensor <- grndmean %>% 
  group_by(sensor, day) %>%
  aggregate(value ~ sensor + day, mean)


Daily_average_grnd_per_sensor <-  cSplit(Daily_average_grnd_per_sensor, 'sensor', sep="-", direction = "wide")
colnames(Daily_average_grnd_per_sensor)[1:4] <- c("date","value","station","sensor")
Daily_average_grnd_per_sensor$fullname <- paste(Daily_average_grnd_per_sensor$station,Daily_average_grnd_per_sensor$sensor,sep="-")


TNHA_DAILY <- Daily_average_grnd_per_sensor %>% filter(station == "TNHA")
SSMH_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "SSMH")
BEO_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "BEO")


date <- rep(seq(as.Date("2022-09-01"), as.Date("2022-12-01"), by="day"),5)
val <- rep(1,length(date))
fullname <- rep(c("TNHA-BASE", "TNHA-SA", "TNHA-SB", "TNHA-SC", "TNHA-SD"),each=92)
testdf <- data.frame(date,fullname,val)
TNHA_NONA <- left_join(testdf,TNHA_DAILY, by=c("date","fullname"))

fullname <- rep(c("SSMH-BASE", "SSMH-SA", "SSMH-SB", "SSMH-SC", "SSMH-SD"),each=92)
testdf2 <- data.frame(date,fullname,val)
SSMH_NONA <- left_join(testdf2,SSMH_DAILY, by=c("date","fullname"))

fullname <- rep(c("BEO-B05", "BEO-B06","FAKEVAR", "FAKEVAR2", "FAKEVAR3"),each=92)
testdf3 <- data.frame(date,fullname,val)
BEO_NONA <- left_join(testdf3,BEO_DAILY, by=c("date","fullname"))

FALL22_10CM <- rbind(TNHA_NONA,BEO_NONA,SSMH_NONA)
FALL22_10CM$depth <- "10cm"
FALL22_10CM$depth <- as.factor(FALL22_10CM$depth)
```

30cm
```{r}
grndmean <- fall22grndtemp %>% subset() %>% select(value,sensor,Date,depth) %>% filter( !value == "-888.8", depth == "30cm") 

grndmean %>%
  mutate(date = day(Date))  %>%
  group_by(date,sensor,value) %>%
  summarize(mean_X1 = mean(value)) %>% 
  aggregate( value ~ sensor, mean ) %>%
  group_by(sensor)

grndmean$time <- format(as.Date(
  grndmean$Date),format = "%H:%M:%S")
grndmean$day <- as.Date(grndmean$Date)


Daily_average_grnd_per_sensor <- grndmean %>% 
  group_by(sensor, day) %>%
  aggregate(value ~ sensor + day, mean)


Daily_average_grnd_per_sensor <-  cSplit(Daily_average_grnd_per_sensor, 'sensor', sep="-", direction = "wide")
colnames(Daily_average_grnd_per_sensor)[1:4] <- c("date","value","station","sensor")
Daily_average_grnd_per_sensor$fullname <- paste(Daily_average_grnd_per_sensor$station,Daily_average_grnd_per_sensor$sensor,sep="-")


TNHA_DAILY <- Daily_average_grnd_per_sensor %>% filter(station == "TNHA")
SSMH_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "SSMH")
BEO_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "BEO")

date <- rep(seq(as.Date("2022-09-01"), as.Date("2022-12-01"), by="day"),5)
val <- rep(1,length(date))
fullname <- rep(c("TNHA-BASE", "TNHA-SA", "TNHA-SB", "TNHA-SC", "TNHA-SD"),each=92)
testdf <- data.frame(date,fullname,val)
TNHA_NONA <- left_join(testdf,TNHA_DAILY, by=c("date","fullname"))

fullname <- rep(c("SSMH-BASE", "SSMH-SA", "SSMH-SB", "SSMH-SC", "SSMH-SD"),each=92)
testdf2 <- data.frame(date,fullname,val)
SSMH_NONA <- left_join(testdf2,SSMH_DAILY, by=c("date","fullname"))

fullname <- rep(c("BEO-B05", "BEO-B06","FAKEVAR", "FAKEVAR2", "FAKEVAR3"),each=92)
testdf3 <- data.frame(date,fullname,val)
BEO_NONA <- left_join(testdf3,BEO_DAILY, by=c("date","fullname"))

FALL22_30CM <- rbind(TNHA_NONA,BEO_NONA,SSMH_NONA)
FALL22_30CM$depth <- "30cm"
FALL22_30CM$depth <- as.factor(FALL22_30CM$depth)
```

55cm
```{r}
grndmean <- fall22grndtemp %>% subset() %>% select(value,sensor,Date,depth) %>% filter( !value == "-888.8", depth == "55cm") 

grndmean %>%
  mutate(date = day(Date))  %>%
  group_by(date,sensor,value) %>%
  summarize(mean_X1 = mean(value)) %>% 
  aggregate( value ~ sensor, mean ) %>%
  group_by(sensor)

grndmean$time <- format(as.Date(
  grndmean$Date),format = "%H:%M:%S")
grndmean$day <- as.Date(grndmean$Date)


Daily_average_grnd_per_sensor <- grndmean %>% 
  group_by(sensor, day) %>%
  aggregate(value ~ sensor + day, mean)


Daily_average_grnd_per_sensor <-  cSplit(Daily_average_grnd_per_sensor, 'sensor', sep="-", direction = "wide")
colnames(Daily_average_grnd_per_sensor)[1:4] <- c("date","value","station","sensor")
Daily_average_grnd_per_sensor$fullname <- paste(Daily_average_grnd_per_sensor$station,Daily_average_grnd_per_sensor$sensor,sep="-")


TNHA_DAILY <- Daily_average_grnd_per_sensor %>% filter(station == "TNHA")
SSMH_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "SSMH")
BEO_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "BEO")


date <- rep(seq(as.Date("2022-09-01"), as.Date("2022-12-01"), by="day"),5)
val <- rep(1,length(date))
fullname <- rep(c("TNHA-BASE", "TNHA-SA", "TNHA-SB", "TNHA-SC", "TNHA-SD"),each=92)
testdf <- data.frame(date,fullname,val)
TNHA_NONA <- left_join(testdf,TNHA_DAILY, by=c("date","fullname"))

fullname <- rep(c("SSMH-BASE", "SSMH-SA", "SSMH-SB", "SSMH-SC", "SSMH-SD"),each=92)
testdf2 <- data.frame(date,fullname,val)
SSMH_NONA <- left_join(testdf2,SSMH_DAILY, by=c("date","fullname"))

fullname <- rep(c("BEO-B05", "BEO-B06","FAKEVAR", "FAKEVAR2", "FAKEVAR3"),each=92)
testdf3 <- data.frame(date,fullname,val)
BEO_NONA <- left_join(testdf3,BEO_DAILY, by=c("date","fullname"))

FALL22_55CM <- rbind(TNHA_NONA,BEO_NONA,SSMH_NONA)
FALL22_55CM$depth <- "55cm"
FALL22_55CM$depth <- as.factor(FALL22_55CM$depth)
```

65cm
```{r}
grndmean <- fall22grndtemp %>% subset() %>% select(value,sensor,Date,depth) %>% filter( !value == "-888.8", depth == "65cm") 

grndmean %>%
  mutate(date = day(Date))  %>%
  group_by(date,sensor,value) %>%
  summarize(mean_X1 = mean(value)) %>% 
  aggregate( value ~ sensor, mean ) %>%
  group_by(sensor)

grndmean$time <- format(as.Date(
  grndmean$Date),format = "%H:%M:%S")
grndmean$day <- as.Date(grndmean$Date)


Daily_average_grnd_per_sensor <- grndmean %>% 
  group_by(sensor, day) %>%
  aggregate(value ~ sensor + day, mean)


Daily_average_grnd_per_sensor <-  cSplit(Daily_average_grnd_per_sensor, 'sensor', sep="-", direction = "wide")
colnames(Daily_average_grnd_per_sensor)[1:4] <- c("date","value","station","sensor")
Daily_average_grnd_per_sensor$fullname <- paste(Daily_average_grnd_per_sensor$station,Daily_average_grnd_per_sensor$sensor,sep="-")


TNHA_DAILY <- Daily_average_grnd_per_sensor %>% filter(station == "TNHA")
SSMH_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "SSMH")
BEO_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "BEO")


date <- rep(seq(as.Date("2022-09-01"), as.Date("2022-12-01"), by="day"),5)
val <- rep(1,length(date))
fullname <- rep(c("TNHA-BASE", "TNHA-SA", "TNHA-SB", "TNHA-SC", "TNHA-SD"),each=92)
testdf <- data.frame(date,fullname,val)
TNHA_NONA <- left_join(testdf,TNHA_DAILY, by=c("date","fullname"))

fullname <- rep(c("SSMH-BASE", "SSMH-SA", "SSMH-SB", "SSMH-SC", "SSMH-SD"),each=92)
testdf2 <- data.frame(date,fullname,val)
SSMH_NONA <- left_join(testdf2,SSMH_DAILY, by=c("date","fullname"))

fullname <- rep(c("BEO-B05", "BEO-B06","FAKEVAR", "FAKEVAR2", "FAKEVAR3"),each=92)
testdf3 <- data.frame(date,fullname,val)
BEO_NONA <- left_join(testdf3,BEO_DAILY, by=c("date","fullname"))

FALL22_65CM <- rbind(TNHA_NONA,BEO_NONA,SSMH_NONA)
FALL22_65CM$depth <- "65cm"
FALL22_65CM$depth <- as.factor(FALL22_65CM$depth)
```

90cm
```{r}
grndmean <- fall22grndtemp %>% subset() %>% select(value,sensor,Date,depth) %>% filter( !value == "-888.8", depth == "90cm") 

grndmean %>%
  mutate(date = day(Date))  %>%
  group_by(date,sensor,value) %>%
  summarize(mean_X1 = mean(value)) %>% 
  aggregate( value ~ sensor, mean ) %>%
  group_by(sensor)

grndmean$time <- format(as.Date(
  grndmean$Date),format = "%H:%M:%S")
grndmean$day <- as.Date(grndmean$Date)


Daily_average_grnd_per_sensor <- grndmean %>% 
  group_by(sensor, day) %>%
  aggregate(value ~ sensor + day, mean)


Daily_average_grnd_per_sensor <-  cSplit(Daily_average_grnd_per_sensor, 'sensor', sep="-", direction = "wide")
colnames(Daily_average_grnd_per_sensor)[1:4] <- c("date","value","station","sensor")
Daily_average_grnd_per_sensor$fullname <- paste(Daily_average_grnd_per_sensor$station,Daily_average_grnd_per_sensor$sensor,sep="-")


TNHA_DAILY <- Daily_average_grnd_per_sensor %>% filter(station == "TNHA")
SSMH_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "SSMH")
BEO_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "BEO")


date <- rep(seq(as.Date("2022-09-01"), as.Date("2022-12-01"), by="day"),5)
val <- rep(1,length(date))
fullname <- rep(c("TNHA-BASE", "TNHA-SA", "TNHA-SB", "TNHA-SC", "TNHA-SD"),each=92)
testdf <- data.frame(date,fullname,val)
TNHA_NONA <- left_join(testdf,TNHA_DAILY, by=c("date","fullname"))

fullname <- rep(c("SSMH-BASE", "SSMH-SA", "SSMH-SB", "SSMH-SC", "SSMH-SD"),each=92)
testdf2 <- data.frame(date,fullname,val)
SSMH_NONA <- left_join(testdf2,SSMH_DAILY, by=c("date","fullname"))

fullname <- rep(c("BEO-B05", "BEO-B06","FAKEVAR", "FAKEVAR2", "FAKEVAR3"),each=92)
testdf3 <- data.frame(date,fullname,val)
BEO_NONA <- left_join(testdf3,BEO_DAILY, by=c("date","fullname"))

FALL22_90CM <- rbind(TNHA_NONA,BEO_NONA,SSMH_NONA)
FALL22_90CM$depth <- "90cm"
FALL22_90CM$depth <- as.factor(FALL22_90CM$depth)
```



Bind all depth dataframes together
```{r}
FALL22_ALLDEPTHS <- rbind(FALL22_10CM,FALL22_30CM,FALL22_55CM,FALL22_65CM,FALL22_90CM)
```






BY SITE
-----------
```{r}
averaged_by_site_TNHA <- FALL22_ALLDEPTHS %>% filter(fullname == "TNHA-BASE" | fullname == "TNHA-SA" | fullname == "TNHA-SB"| fullname == "TNHA-SC" | fullname == "TNHA-SD") %>% aggregate(value~date+depth, mean)
averaged_by_site_TNHA$station <- c("TNHA")

averaged_by_site_BEO <- FALL22_ALLDEPTHS %>% filter(fullname == "BEO-B06"| fullname == "BEO-B05") %>% aggregate(value~date+depth, mean)
averaged_by_site_BEO$station <- c("BEO") 

averaged_by_site_SSMH <- FALL22_ALLDEPTHS %>% filter(fullname == "SSMH-BASE" | fullname == "SSMH-SA" | fullname == "SSMH-SB"| fullname == "SSMH-SC" | fullname == "SSMH-SD") %>% aggregate(value~date+depth, mean)
averaged_by_site_SSMH$station <- c("SSMH")

SITES_AVG_FALL22_GRND <- rbind(averaged_by_site_BEO, averaged_by_site_TNHA, averaged_by_site_SSMH)
```








*SUMMER 23*
-----------------------
BY STATION
-------------------
10cm
```{r}
grndmean <- sum23grndtmp %>% subset() %>% select(value,sensor,Date,depth) %>% filter( !value == "-888.8", depth == "10cm") 

grndmean %>%
  mutate(date = day(Date))  %>%
  group_by(date,sensor,value) %>%
  summarize(mean_X1 = mean(value)) %>% 
  aggregate( value ~ sensor, mean ) %>%
  group_by(sensor)

grndmean$time <- format(as.Date(
  grndmean$Date),format = "%H:%M:%S")
grndmean$day <- as.Date(grndmean$Date)


Daily_average_grnd_per_sensor <- grndmean %>% 
  group_by(sensor, day) %>%
  aggregate(value ~ sensor + day, mean)


Daily_average_grnd_per_sensor <-  cSplit(Daily_average_grnd_per_sensor, 'sensor', sep="-", direction = "wide")
colnames(Daily_average_grnd_per_sensor)[1:4] <- c("date","value","station","sensor")
Daily_average_grnd_per_sensor$fullname <- paste(Daily_average_grnd_per_sensor$station,Daily_average_grnd_per_sensor$sensor,sep="-")


TNHA_DAILY <- Daily_average_grnd_per_sensor %>% filter(station == "TNHA")
SSMH_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "SSMH")
BEO_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "BEO")


date <- rep(seq(as.Date("2023-06-01"), as.Date("2023-09-01"), by="day"),5)
val <- rep(1,length(date))
fullname <- rep(c("TNHA-BASE", "TNHA-SA", "TNHA-SB", "TNHA-SC", "TNHA-SD"),each=93)
testdf <- data.frame(date,fullname,val)
TNHA_NONA <- left_join(testdf,TNHA_DAILY, by=c("date","fullname"))

fullname <- rep(c("SSMH-BASE", "SSMH-SA", "SSMH-SB", "SSMH-SC", "SSMH-SD"),each=93)
testdf2 <- data.frame(date,fullname,val)
SSMH_NONA <- left_join(testdf2,SSMH_DAILY, by=c("date","fullname"))

fullname <- rep(c("BEO-B05", "BEO-B06","FAKEVAR", "FAKEVAR2", "FAKEVAR3"),each=93)
testdf3 <- data.frame(date,fullname,val)
BEO_NONA <- left_join(testdf3,BEO_DAILY, by=c("date","fullname"))

SUMMER23_10CM <- rbind(TNHA_NONA,BEO_NONA,SSMH_NONA)
SUMMER23_10CM$depth <- "10cm"
SUMMER23_10CM$depth <- as.factor(SUMMER23_10CM$depth)
```

30cm
```{r}
grndmean <- sum23grndtmp %>% subset() %>% select(value,sensor,Date,depth) %>% filter( !value == "-888.8", depth == "30cm") 

grndmean %>%
  mutate(date = day(Date))  %>%
  group_by(date,sensor,value) %>%
  summarize(mean_X1 = mean(value)) %>% 
  aggregate( value ~ sensor, mean ) %>%
  group_by(sensor)

grndmean$time <- format(as.Date(
  grndmean$Date),format = "%H:%M:%S")
grndmean$day <- as.Date(grndmean$Date)


Daily_average_grnd_per_sensor <- grndmean %>% 
  group_by(sensor, day) %>%
  aggregate(value ~ sensor + day, mean)


Daily_average_grnd_per_sensor <-  cSplit(Daily_average_grnd_per_sensor, 'sensor', sep="-", direction = "wide")
colnames(Daily_average_grnd_per_sensor)[1:4] <- c("date","value","station","sensor")
Daily_average_grnd_per_sensor$fullname <- paste(Daily_average_grnd_per_sensor$station,Daily_average_grnd_per_sensor$sensor,sep="-")


TNHA_DAILY <- Daily_average_grnd_per_sensor %>% filter(station == "TNHA")
SSMH_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "SSMH")
BEO_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "BEO")


date <- rep(seq(as.Date("2023-06-01"), as.Date("2023-09-01"), by="day"),5)
val <- rep(1,length(date))
fullname <- rep(c("TNHA-BASE", "TNHA-SA", "TNHA-SB", "TNHA-SC", "TNHA-SD"),each=93)
testdf <- data.frame(date,fullname,val)
TNHA_NONA <- left_join(testdf,TNHA_DAILY, by=c("date","fullname"))

fullname <- rep(c("SSMH-BASE", "SSMH-SA", "SSMH-SB", "SSMH-SC", "SSMH-SD"),each=93)
testdf2 <- data.frame(date,fullname,val)
SSMH_NONA <- left_join(testdf2,SSMH_DAILY, by=c("date","fullname"))

fullname <- rep(c("BEO-B05", "BEO-B06","FAKEVAR", "FAKEVAR2", "FAKEVAR3"),each=93)
testdf3 <- data.frame(date,fullname,val)
BEO_NONA <- left_join(testdf3,BEO_DAILY, by=c("date","fullname"))

SUMMER23_30CM <- rbind(TNHA_NONA,BEO_NONA,SSMH_NONA)
SUMMER23_30CM$depth <- "30cm"
SUMMER23_30CM$depth <- as.factor(SUMMER23_30CM$depth)
```

55cm
```{r}
grndmean <- sum23grndtmp %>% subset() %>% select(value,sensor,Date,depth) %>% filter( !value == "-888.8", depth == "55cm") 

grndmean %>%
  mutate(date = day(Date))  %>%
  group_by(date,sensor,value) %>%
  summarize(mean_X1 = mean(value)) %>% 
  aggregate( value ~ sensor, mean ) %>%
  group_by(sensor)

grndmean$time <- format(as.Date(
  grndmean$Date),format = "%H:%M:%S")
grndmean$day <- as.Date(grndmean$Date)


Daily_average_grnd_per_sensor <- grndmean %>% 
  group_by(sensor, day) %>%
  aggregate(value ~ sensor + day, mean)


Daily_average_grnd_per_sensor <-  cSplit(Daily_average_grnd_per_sensor, 'sensor', sep="-", direction = "wide")
colnames(Daily_average_grnd_per_sensor)[1:4] <- c("date","value","station","sensor")
Daily_average_grnd_per_sensor$fullname <- paste(Daily_average_grnd_per_sensor$station,Daily_average_grnd_per_sensor$sensor,sep="-")


TNHA_DAILY <- Daily_average_grnd_per_sensor %>% filter(station == "TNHA")
SSMH_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "SSMH")
BEO_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "BEO")


date <- rep(seq(as.Date("2023-06-01"), as.Date("2023-09-01"), by="day"),5)
val <- rep(1,length(date))
fullname <- rep(c("TNHA-BASE", "TNHA-SA", "TNHA-SB", "TNHA-SC", "TNHA-SD"),each=93)
testdf <- data.frame(date,fullname,val)
TNHA_NONA <- left_join(testdf,TNHA_DAILY, by=c("date","fullname"))

fullname <- rep(c("SSMH-BASE", "SSMH-SA", "SSMH-SB", "SSMH-SC", "SSMH-SD"),each=93)
testdf2 <- data.frame(date,fullname,val)
SSMH_NONA <- left_join(testdf2,SSMH_DAILY, by=c("date","fullname"))

fullname <- rep(c("BEO-B05", "BEO-B06","FAKEVAR", "FAKEVAR2", "FAKEVAR3"),each=93)
testdf3 <- data.frame(date,fullname,val)
BEO_NONA <- left_join(testdf3,BEO_DAILY, by=c("date","fullname"))

SUMMER23_55CM <- rbind(TNHA_NONA,BEO_NONA,SSMH_NONA)
SUMMER23_55CM$depth <- "55cm"
SUMMER23_55CM$depth <- as.factor(SUMMER23_55CM$depth)
```

65cm
```{r}
grndmean <- sum23grndtmp %>% subset() %>% select(value,sensor,Date,depth) %>% filter( !value == "-888.8", depth == "65cm") 

grndmean %>%
  mutate(date = day(Date))  %>%
  group_by(date,sensor,value) %>%
  summarize(mean_X1 = mean(value)) %>% 
  aggregate( value ~ sensor, mean ) %>%
  group_by(sensor)

grndmean$time <- format(as.Date(
  grndmean$Date),format = "%H:%M:%S")
grndmean$day <- as.Date(grndmean$Date)


Daily_average_grnd_per_sensor <- grndmean %>% 
  group_by(sensor, day) %>%
  aggregate(value ~ sensor + day, mean)


Daily_average_grnd_per_sensor <-  cSplit(Daily_average_grnd_per_sensor, 'sensor', sep="-", direction = "wide")
colnames(Daily_average_grnd_per_sensor)[1:4] <- c("date","value","station","sensor")
Daily_average_grnd_per_sensor$fullname <- paste(Daily_average_grnd_per_sensor$station,Daily_average_grnd_per_sensor$sensor,sep="-")


TNHA_DAILY <- Daily_average_grnd_per_sensor %>% filter(station == "TNHA")
SSMH_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "SSMH")
BEO_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "BEO")


date <- rep(seq(as.Date("2023-06-01"), as.Date("2023-09-01"), by="day"),5)
val <- rep(1,length(date))
fullname <- rep(c("TNHA-BASE", "TNHA-SA", "TNHA-SB", "TNHA-SC", "TNHA-SD"),each=93)
testdf <- data.frame(date,fullname,val)
TNHA_NONA <- left_join(testdf,TNHA_DAILY, by=c("date","fullname"))

fullname <- rep(c("SSMH-BASE", "SSMH-SA", "SSMH-SB", "SSMH-SC", "SSMH-SD"),each=93)
testdf2 <- data.frame(date,fullname,val)
SSMH_NONA <- left_join(testdf2,SSMH_DAILY, by=c("date","fullname"))

fullname <- rep(c("BEO-B05", "BEO-B06","FAKEVAR", "FAKEVAR2", "FAKEVAR3"),each=93)
testdf3 <- data.frame(date,fullname,val)
BEO_NONA <- left_join(testdf3,BEO_DAILY, by=c("date","fullname"))

SUMMER23_65CM <- rbind(TNHA_NONA,BEO_NONA,SSMH_NONA)
SUMMER23_65CM$depth <- "65cm"
SUMMER23_65CM$depth <- as.factor(SUMMER23_65CM$depth)
```

90cm
```{r}
grndmean <- sum23grndtmp %>% subset() %>% select(value,sensor,Date,depth) %>% filter( !value == "-888.8", depth == "90cm") 

grndmean %>%
  mutate(date = day(Date))  %>%
  group_by(date,sensor,value) %>%
  summarize(mean_X1 = mean(value)) %>% 
  aggregate( value ~ sensor, mean ) %>%
  group_by(sensor)

grndmean$time <- format(as.Date(
  grndmean$Date),format = "%H:%M:%S")
grndmean$day <- as.Date(grndmean$Date)


Daily_average_grnd_per_sensor <- grndmean %>% 
  group_by(sensor, day) %>%
  aggregate(value ~ sensor + day, mean)


Daily_average_grnd_per_sensor <-  cSplit(Daily_average_grnd_per_sensor, 'sensor', sep="-", direction = "wide")
colnames(Daily_average_grnd_per_sensor)[1:4] <- c("date","value","station","sensor")
Daily_average_grnd_per_sensor$fullname <- paste(Daily_average_grnd_per_sensor$station,Daily_average_grnd_per_sensor$sensor,sep="-")


TNHA_DAILY <- Daily_average_grnd_per_sensor %>% filter(station == "TNHA")
SSMH_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "SSMH")
BEO_DAILY<- Daily_average_grnd_per_sensor %>% filter(station == "BEO")


date <- rep(seq(as.Date("2023-06-01"), as.Date("2023-09-01"), by="day"),5)
val <- rep(1,length(date))
fullname <- rep(c("TNHA-BASE", "TNHA-SA", "TNHA-SB", "TNHA-SC", "TNHA-SD"),each=93)
testdf <- data.frame(date,fullname,val)
TNHA_NONA <- left_join(testdf,TNHA_DAILY, by=c("date","fullname"))

fullname <- rep(c("SSMH-BASE", "SSMH-SA", "SSMH-SB", "SSMH-SC", "SSMH-SD"),each=93)
testdf2 <- data.frame(date,fullname,val)
SSMH_NONA <- left_join(testdf2,SSMH_DAILY, by=c("date","fullname"))

fullname <- rep(c("BEO-B05", "BEO-B06","FAKEVAR", "FAKEVAR2", "FAKEVAR3"),each=93)
testdf3 <- data.frame(date,fullname,val)
BEO_NONA <- left_join(testdf3,BEO_DAILY, by=c("date","fullname"))

SUMMER23_90CM <- rbind(TNHA_NONA,BEO_NONA,SSMH_NONA)
SUMMER23_90CM$depth <- "90cm"
SUMMER23_90CM$depth <- as.factor(SUMMER23_90CM$depth)
```


Bind all depth dataframes together
```{r}
SUMMERGRND23_ALLDEPTHS <- rbind(SUMMER23_10CM,SUMMER23_30CM,SUMMER23_55CM,SUMMER23_65CM,SUMMER23_90CM)
```

BY SITE
*I still need to force the NA values to remain in this chunk below -- i've tried adding "val" to the aggregate function and na.rm=FALSE to preserve the NA values but it does not seem to have worked thus far*

*Curious - technically the NA values would not matter since we're averaging over the entire time period - but they should still exist in the dataframe for the sake of data preservation?*
-----------
```{r}
averaged_by_site_TNHA <- SUMMERGRND23_ALLDEPTHS %>% filter(fullname == "TNHA-BASE" | fullname == "TNHA-SA" | fullname == "TNHA-SB"| fullname == "TNHA-SC" | fullname == "TNHA-SD") %>% aggregate(value~date+depth, mean)
averaged_by_site_TNHA$station <- c("TNHA")

averaged_by_site_BEO <- SUMMERGRND23_ALLDEPTHS %>% filter(fullname == "BEO-B06" | fullname == "BEO-B05") %>% aggregate(value~date+depth, mean)
averaged_by_site_BEO$station <- c("BEO") 

averaged_by_site_SSMH <- SUMMERGRND23_ALLDEPTHS %>% filter(fullname == "SSMH-BASE" | fullname == "SSMH-SA" | fullname == "SSMH-SB"| fullname == "SSMH-SC" | fullname == "SSMH-SD") %>% aggregate(value~date+depth, mean)
averaged_by_site_SSMH$station <- c("SSMH")

SITES_AVG_SUM23_GRND <- rbind(averaged_by_site_BEO, averaged_by_site_TNHA, averaged_by_site_SSMH)
```




Merge summer 22 + summer 23 data-sets for plotting (by STATION)
-------------
*This DOES preserve all of the NA values when we average over DAY, seems that daily averaging is OK with NA's but seasonal averaging is NOT*
```{r}
#makes an additonal column substring of the month and day only for both 22 and 23 data
#makes an additonal column substring of the year only for both 22 and 23 data
#rbind the 22 and 23 data

SUMMERGRND22_ALLDEPTHS$day <- substr(SUMMERGRND22_ALLDEPTHS$date, 6,10)
SUMMERGRND22_ALLDEPTHS$day <- as.Date(SUMMERGRND22_ALLDEPTHS$day, format = "%m-%d")
SUMMERGRND22_ALLDEPTHS$year <- substr(SUMMERGRND22_ALLDEPTHS$date, 1,4)

SUMMERGRND23_ALLDEPTHS$day <- substr(SUMMERGRND23_ALLDEPTHS$date, 6,10)
SUMMERGRND23_ALLDEPTHS$year <- substr(SUMMERGRND23_ALLDEPTHS$date, 1,4)
SUMMERGRND23_ALLDEPTHS$day <- as.Date(SUMMERGRND23_ALLDEPTHS$day, format = "%m-%d")

SUMMER_22_23_GRNDTMP <- rbind(SUMMERGRND22_ALLDEPTHS,SUMMERGRND23_ALLDEPTHS)

Sum22_Sum23_Annual_Temps <- SUMMER_22_23_GRNDTMP %>% aggregate(value~year+fullname+depth, mean)
# above 
```









